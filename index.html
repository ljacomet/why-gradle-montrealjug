<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><title>: Why Gradle?</title><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><link href="reveal.js/css/reveal.css" rel="stylesheet" /><link rel="stylesheet" href="reveal.js/css/theme/gradle.css" id="theme" /><!--This CSS is generated by the Asciidoctor-Reveal.js converter to further integrate AsciiDoc's existing semantic with Reveal.js--><style type="text/css">.reveal div.right {
  float: right;
}

/* callouts */
.conum[data-value] {display:inline-block;color:#fff!important;background-color:rgba(50,150,50,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}</style><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" /><link href="reveal.js/lib/css/zenburn.css" rel="stylesheet" /><script>var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? "reveal.js/css/print/pdf.css" : "reveal.js/css/print/paper.css";
document.getElementsByTagName( 'head' )[0].appendChild( link );</script><!--[if lt IE 9]><script src="reveal.js/lib/js/html5shiv.js"></script><![endif]-->
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-player.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/asciinema-theme-gradle.css" />
<link rel="stylesheet" type="text/css" href="reveal.js/css/theme/highlight-theme.css" />
<script src="reveal.js/css/theme/asciinema-player.js"></script></head><body><div class="reveal"><div class="slides"><section class="title" data-state="title" data-transition="zoom" data-transition-speed="fast" data-background-image="./images/title.png"><h1></h1><h2>Why Gradle?</h2><div class="preamble"><div class="paragraph"><p><h3>
<div style="font-size: .75em; padding-top:30px">
Louis Jacomet - Gradle Inc.
</div>
</h3></p></div></div></section>
<section id="who-am-i"><h2>Who am I?</h2><div class="imageblock" style=""><img src="./images/blog_head_round.png" alt="blog head round" width="250" height="250" /></div>
<div class="paragraph"><p><span class="icon"><i class="fa fa-github"></i></span> ljacomet &nbsp; <span class="icon"><i class="fa fa-twitter"></i></span> @ljacomet</p></div>
<div class="ulist"><ul><li><p>Lead software engineer @ Gradle</p><div class="ulist"><ul><li><p>Part of the JVM ecosystem team</p></li></ul></div></li><li><p>Previously worked for Terracotta on Ehcache</p></li><li><p>Started my career as a contractor</p></li></ul></div></section>
<section><section id="gradle-s-mission" data-background-color="#01303a"><h2>Gradle&#8217;s mission</h2></section><section id="developer-productivity"><h2>Developer productivity</h2><div class="ulist"><ul><li class="fragment"><p><strong>Fast</strong> feedback cycles</p></li></ul></div></section></section>
<section><section id="modelling-the-system" data-background-color="#01303a"><h2>Modelling the system</h2></section><section id="java-classpath"><h2>Java classpath</h2><div class="ulist"><ul><li class="fragment"><p>Input: jars or class directories</p></li><li class="fragment"><p>Jar: class files</p></li><li class="fragment"><p>Class file: both API and implementation</p></li></ul></div></section><section id="compile-classpath"><h2>Compile classpath</h2><div class="paragraph"><p>What does the Java compiler cares about?</p></div>
<div class="ulist"><ul><li class="fragment"><p>Accessible class names</p></li><li class="fragment"><p>Accessible method signatures</p></li></ul></div></section><section id="compile-classpath-2"><h2>Compile classpath</h2><div class="paragraph"><p><strong>Only accessible signatures matter</strong></p></div></section><section id="runtime-classpath"><h2>Runtime classpath</h2><div class="paragraph"><p>What does the Java runtime cares about?</p></div></section><section id="runtime-classpath-2"><h2>Runtime classpath</h2><div class="paragraph"><p>At runtime, <strong>everything</strong> matters, from classes to resources.</p></div></section><section id="compile-avoidance"><h2>Compile avoidance</h2><div class="ulist"><ul><li class="fragment"><p><em>compile</em> and <em>runtime</em> classpath have different <em>semantics</em></p></li><li class="fragment"><p>Gradle models the difference</p></li><li class="fragment"><p>Ignores irrelevant (non ABI) changes to compile classpath</p></li></ul></div></section><section id="icing-on-the-cake"><h2>Icing on the cake</h2><div class="ulist"><ul><li class="fragment"><p>Upgrade a dependency from <code>1.0.1</code> to <code>1.0.2</code></p></li><li class="fragment"><p>If ABI hasn&#8217;t changed, Gradle will <em>not</em> recompile</p></li><li class="fragment"><p>Even if the name of the jar is different (<code>mydep-1.0.1.jar</code> vs <code>mydep-1.0.2.jar</code>)</p></li><li class="fragment"><p>Because only <em>contents</em> matter</p></li></ul></div></section><section id="more-modelling-with-dependencies-configurations"><h2>More modelling with dependencies configurations</h2><div class="imageblock" style=""><img src="./images/java-library-ignore-deprecated-main.png" alt="java library ignore deprecated main" width="1000" height="0%" /></div>
<div class="ulist"><ul><li class="fragment"><p><code>compile</code> and <code>runtime</code> were <em>only</em> about <em>compilation</em></p></li><li class="fragment"><p><code>api</code>, <code>implementation</code> and friends are about <em>compilation</em> and <em>publication / consumption</em></p></li></ul></div></section></section>
<section><section id="incremental-builds" data-background-color="#01303a"><h2>Incremental builds</h2></section><section id="why-does-it-matter"><h2>Why does it matter?</h2><div class="ulist"><ul><li><p>Gradle is meant for incremental builds</p></li><li><p><code>clean</code> is a waste of time</p></li></ul></div></section><section id="the-em-incrementality-em-test"><h2>The <em>incrementality</em> test</h2><div class="ulist"><ul><li class="fragment"><p>Run a build</p></li><li class="fragment"><p>Run again with no change</p></li><li class="fragment"><p>If a task was re-executed, time is wasted</p><div class="ulist"><ul><li class="fragment"><p>Investigate!</p></li></ul></div></li></ul></div></section><section id="tasks-as-functions"><h2>Tasks as functions</h2><div class="ulist"><ul><li><p>What are the task inputs?</p></li><li><p>What are the task outputs?</p></li><li><p>What if one of them changes?</p></li></ul></div></section><section id="know-why-your-task-is-out-of-date"><h2>Know why your task is out-of-date</h2><div class="imageblock" style=""><img src="./images/task-out-of-date.png" alt="task out of date" width="1280" height="415" /></div></section><section id="incremental-task-inputs"><h2>Incremental task inputs</h2><div class="ulist"><ul><li><p>Know precisely <em>which</em> files have changed</p></li><li><p>Task action can perform the minimal amount of work</p></li></ul></div></section></section>
<section><section id="build-cache" data-background-color="#01303a"><h2>Build cache</h2></section><section id="how-does-it-work"><h2>How does it work?</h2><div class="paragraph"><p>With up-to-date checks, Gradle is:</p></div>
<div class="ulist"><ul><li class="fragment"><p>Reusing results</p></li><li class="fragment"><p>Rrom <strong>last time</strong></p></li><li class="fragment"><p>When we ran <strong>this build</strong></p></li><li class="fragment"><p>On <strong>this machine</strong></p></li></ul></div></section><section id="gradle-can-do-better"><h2>Gradle can do better</h2></section><section id="why-not"><h2>Why not&#8230;&#8203;</h2><div class="paragraph"><p>Have Gradle:</p></div>
<div class="ulist"><ul><li class="fragment"><p>Reuse results</p></li><li class="fragment"><p>From <strong>anytime before</strong></p></li><li class="fragment"><p>When we ran <strong>any build</strong></p></li><li class="fragment"><p>On <strong>this machine</strong></p></li></ul></div></section><section id="or-even-better"><h2>Or even better &#8230;&#8203;</h2><div class="paragraph"><p>Reuse results<br />
from <strong>anytime before</strong> <br />
when we ran <strong>any build</strong><br />
 <strong>anywhere</strong>.</p></div></section><section id="builds-on-top-of-incremental-builds"><h2>Builds on top of incremental builds</h2><div class="ulist"><ul><li class="fragment"><p>Get reliable incremental builds first</p></li><li class="fragment"><p>Next work on making them cacheable</p></li><li class="fragment"><p>Cacheable tasks require additional information for path sensitivity</p></li></ul></div></section><section id="repeatable-outputs"><h2>Repeatable outputs</h2><div class="ulist"><ul><li class="fragment"><p>Same inputs must produce same outputs</p></li><li class="fragment"><p>May be byte-for-byte equivalent</p></li><li class="fragment"><p>May be semantically equivalent (with normalization)</p></li></ul></div></section><section id="normalization"><h2>Normalization</h2><div class="ulist"><ul><li class="fragment"><p><code>@InputFiles</code> - no normalization</p></li><li class="fragment"><p><code>@CompileClasspath</code> - Extracts ABI from classes</p></li><li class="fragment"><p><code>@Classpath</code> - treats files as a runtime Java classpath</p><div class="ulist"><ul><li><p>Configurable runtime normalization to ignore some files</p></li></ul></div></li></ul></div></section><section id="deploying-a-build-cache"><h2>Deploying a build cache</h2><div class="ulist"><ul><li><p>Stable for Java, Groovy and Scala projects</p></li><li><p>Gradle Enterprise provides a backend for managing, monitoring and replicating caches</p></li><li><p>Dockerhub: <a href="https://hub.docker.com/r/gradle/build-cache-node/">gradle/build-cache-node</a></p></li></ul></div></section></section>
<section><section id="dependency-management-with-gradle-6" data-background-color="#01303a"><h2>Dependency Management with Gradle 6</h2></section><section id="dependency-and-version-declarations"><h2>Dependency and version declarations</h2><div class="ulist"><ul><li class="fragment"><p>Dependency constraints, platforms</p></li><li class="fragment"><p>Rich versions</p></li><li class="fragment"><p><code>compile</code> and <code>runtime</code> deprecated</p></li></ul></div></section><section id="platforms-to-share-versions"><h2>Platforms to share versions</h2><div class="title">platform/build.gradle.kts</div><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">plugins {
   `java-platform`
}

dependencies {
    constraints {
       api("org.slf4j:slf4j-api:1.7.26")
       runtime("org.slf4j:slf4j-simple:1.7.26")
    }
}</code></pre>
<div class="title">cli/build.gradle.kts</div><pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
   api(platform(project(":platform")))

   implementation("org.slf4j:slf4j-api") // &lt;-- no version here
}</code></pre></section><section id="rich-dependency-versions"><h2>Rich dependency versions</h2><div class="ulist"><ul><li><p>Works also with dependency constraints</p></li></ul></div>
<pre class="highlight listingblock"><code data-noescape="" class="groovy language-groovy">dependencies {
   implementation("info.picocli:picocli") {
       version {
          requires("[3.9, 4.0[")
          prefer("3.9.5")
       }
       because("Provides command-line argument parsing")
   }
}</code></pre></section><section id="the-famous-logging-problem"><h2>The famous logging problem</h2><div class="ulist"><ul><li class="fragment"><p>Slf4j and bridging / replacement modules</p></li><li class="fragment"><p><code>log4j</code> vs. <code>slf4j-log4j12</code> vs. <code>log4j-over-slf4j</code></p></li><li class="fragment"><p>And similarly for <code>java.util.logging</code></p></li><li class="fragment"><p>And again for <code>commons-logging</code></p></li><li class="fragment"><p>And of course, do not forget <code>log4j</code> 2!</p></li></ul></div></section><section id="relocated-libraries"><h2>Relocated libraries</h2><div class="ulist"><ul><li class="fragment"><p><code>asm:asm</code> now known as <code>org.ow2.asm:asm</code></p></li><li class="fragment"><p><code>junit:junit-dep</code> and <code>junit:junit</code></p></li><li class="fragment"><p><code>cglib:cglib-nodep</code> and <code>cglib:cglib</code></p></li></ul></div></section><section id="handling-mutually-exclusive-modules"><h2>Handling mutually exclusive modules</h2><div class="ulist"><ul><li><p>A <em>capability</em> describes a feature that is mutually exclusive</p></li><li><p>All components provide their GAV as a capability by default</p></li></ul></div></section><section id="capabilities-example"><h2>Capabilities example</h2><pre class="highlight listingblock"><code data-noescape="">dependencies {
    components {
        // both slf4j-simple and slf4j-log4j12 implement the slf4j api
        withModule("org.slf4j:slf4j-simple", Slf4jImplCapability::class.java)
        withModule("org.slf4j:slf4j-log4j12", Slf4jImplCapability::class.java)
    }
}
class Slf4jImplCapability : ComponentMetadataRule {
    override fun execute(context: ComponentMetadataContext) = context.run {
        details.allVariants {
            withCapabilities {
                addCapability("my.project", "slf4j-impl", "1.0")
            }
        }
    }
}</code></pre></section><section id="misaligned-dependencies"><h2>Misaligned dependencies</h2><div class="ulist"><ul><li><p>A group of dependencies are designed to work together.</p><div class="ulist"><ul><li><p>Think <code>jackson</code> or even the Spring framework</p></li></ul></div></li><li><p>Through transitive dependency updates, modules end up having different versions</p></li></ul></div>
<div class="paragraph"><p>So the goal would be to have the tools to make sure that <em>any</em> upgrade of <em>any</em> module would cause the whole set to upgrade its version(s).</p></div></section><section id="solving-the-issue-in-gradle"><h2>Solving the issue in Gradle</h2><div class="ulist"><ul><li class="fragment"><p>By enhancing module metadata</p><div class="ulist"><ul><li class="fragment"><p>Using <em>virtual</em> platform</p><div class="ulist"><ul><li><p>Gradle <em>attempts</em> alignment</p></li></ul></div></li><li class="fragment"><p>Using <em>published</em> BOM</p><div class="ulist"><ul><li><p>Gradle will respect the versions from the BOM</p></li></ul></div></li></ul></div></li></ul></div></section><section id="enhancing-metadata-example"><h2>Enhancing metadata example</h2><pre class="highlight listingblock"><code data-noescape="">open class JacksonAlignmentRule : ComponentMetadataRule {
    override fun execute(ctx: ComponentMetadataContext) {
        ctx.details.run {
            if (id.group.startsWith("com.fasterxml.jackson")) {
                belongsTo("my.jackson:jackson-platform:${id.version}")
            }
        }
    }
}</code></pre></section><section id="all-new-in-6"><h2>All new in 6??</h2><div class="paragraph"><p>Well, not really 🤭</p></div>
<div class="ulist"><ul><li class="fragment"><p>Dependency constraints &#8594; 4.5</p></li><li class="fragment"><p>Platforms &#8594; 5.0</p></li><li class="fragment"><p>Java platform plugin &#8594; 5.2</p></li><li class="fragment"><p>Rich versions &#8594; 4.4</p><div class="ulist"><ul><li><p><code>strictly</code> semantics &#8594; 6.0 🙌</p></li></ul></div></li><li class="fragment"><p>Capabilities &#8594; 4.7</p></li><li class="fragment"><p>Alignment &#8594; 4.10</p></li><li class="fragment"><p>&#8230;&#8203;</p></li></ul></div></section></section>
<section><section id="metadata-revolution" data-background-color="#01303a"><h2>Metadata revolution</h2></section><section id="erase-differences-between-projects-and-binaries"><h2>Erase differences between projects and binaries</h2><div class="ulist"><ul><li class="fragment"><p>Most of the features discussed previously <em>did not</em> apply outside of project boundaries.</p></li><li class="fragment"><p>Neither the Maven POM or the Ivy XML are rich enough to model <em>all</em> these concepts.</p></li><li class="fragment"><p>That&#8217;s why, by default in 6.0, Gradle will generate its own metadata file.</p></li></ul></div></section><section id="what-is-this-format"><h2>What is this format?</h2><pre class="highlight listingblock"><code data-noescape="" class="json language-json">{
  "formatVersion": "1.1",
  "component": {
    "group": "org.junit.jupiter",
    "module": "junit-jupiter-api",
    "version": "5.6.0-M1",
    "attributes": {
      "org.gradle.status": "release"
    }
  },
  "createdBy": {
    "gradle": {
      "version": "6.0-rc-1",
      "buildId": "kp3x4r2epbc3lbltvvuwkndxy4"
    }
  },
  "variants": [
    {
      "name": "apiElements",
      "attributes": {
        "org.gradle.category": "library",
        "org.gradle.dependency.bundling": "external",
        "org.gradle.jvm.version": 8,
        "org.gradle.libraryelements": "jar",
        "org.gradle.usage": "java-api",
        "org.jetbrains.kotlin.localToProject": "public",
        "org.jetbrains.kotlin.platform.type": "jvm"
      },
      "dependencies": [
        {
          "group": "org.junit",
          "module": "junit-bom",
          "version": {
            "requires": "5.6.0-M1"
          },
          "attributes": {
            "org.gradle.category": "platform"
          },
          "endorseStrictVersions": true
        },
        {
          "group": "org.apiguardian",
          "module": "apiguardian-api",
          "version": {
            "requires": "1.1.0"
          }
        },
        {
          "group": "org.opentest4j",
          "module": "opentest4j",
          "version": {
            "requires": "1.2.0"
          }
        },
        {
          "group": "org.junit.platform",
          "module": "junit-platform-commons",
          "version": {
            "requires": "1.6.0-M1"
          }
        }
      ],
      "files": [
        {
          "name": "junit-jupiter-api-5.6.0-M1.jar",
          "url": "junit-jupiter-api-5.6.0-M1.jar",
          "size": 146229,
          "sha512": "249b3357fb8fc2b90106717eff6aac0f549bb2f4e18653f8264e57dec1ff2c7aa9f0771d51feac3b2e78ac0a3297fe1f0f01b224ed42921968282ea360090f4c",
          "sha256": "48b736cdb4fd0e350d204e56d85222d4e1ca86d00a70639bebc49c7c84f72134",
          "sha1": "876361abf395adf5f0f6b7d6f7095327a7c569dd",
          "md5": "8970a277ce4d5070d1f2f180fe69417c"
        }
      ]
    },
    {
      "name": "runtimeElements",
      "attributes": {
        "org.gradle.category": "library",
        "org.gradle.dependency.bundling": "external",
        "org.gradle.jvm.version": 8,
        "org.gradle.libraryelements": "jar",
        "org.gradle.usage": "java-runtime",
        "org.jetbrains.kotlin.localToProject": "public",
        "org.jetbrains.kotlin.platform.type": "jvm"
      },
      "dependencies": [
        {
          "group": "org.junit",
          "module": "junit-bom",
          "version": {
            "requires": "5.6.0-M1"
          },
          "attributes": {
            "org.gradle.category": "platform"
          },
          "endorseStrictVersions": true
        },
        {
          "group": "org.apiguardian",
          "module": "apiguardian-api",
          "version": {
            "requires": "1.1.0"
          }
        },
        {
          "group": "org.opentest4j",
          "module": "opentest4j",
          "version": {
            "requires": "1.2.0"
          }
        },
        {
          "group": "org.junit.platform",
          "module": "junit-platform-commons",
          "version": {
            "requires": "1.6.0-M1"
          }
        }
      ],
      "files": [
        {
          "name": "junit-jupiter-api-5.6.0-M1.jar",
          "url": "junit-jupiter-api-5.6.0-M1.jar",
          "size": 146229,
          "sha512": "249b3357fb8fc2b90106717eff6aac0f549bb2f4e18653f8264e57dec1ff2c7aa9f0771d51feac3b2e78ac0a3297fe1f0f01b224ed42921968282ea360090f4c",
          "sha256": "48b736cdb4fd0e350d204e56d85222d4e1ca86d00a70639bebc49c7c84f72134",
          "sha1": "876361abf395adf5f0f6b7d6f7095327a7c569dd",
          "md5": "8970a277ce4d5070d1f2f180fe69417c"
        }
      ]
    },
    {
      "name": "javadocElements",
      "attributes": {
        "org.gradle.category": "documentation",
        "org.gradle.dependency.bundling": "external",
        "org.gradle.docstype": "javadoc",
        "org.gradle.usage": "java-runtime"
      },
      "files": [
        {
          "name": "junit-jupiter-api-5.6.0-M1-javadoc.jar",
          "url": "junit-jupiter-api-5.6.0-M1-javadoc.jar",
          "size": 948381,
          "sha512": "9df559a2dd05d96be4182498b6fa9578171dfcbca803110676402a08d4b9e5d83a0c5e94a6c653ab91542ceb798e692d71f0c8b2e7e393db237cdce3e82e7b61",
          "sha256": "e88d507de28a6e64693e9004647e2e9e24063b2cbaa27da9229eafd5b24ae012",
          "sha1": "9e172b78eb85b72bf02bb733c3addeddbf3eea2b",
          "md5": "be312470679609ff331e62091ca6d90e"
        }
      ]
    },
    {
      "name": "sourcesElements",
      "attributes": {
        "org.gradle.category": "documentation",
        "org.gradle.dependency.bundling": "external",
        "org.gradle.docstype": "sources",
        "org.gradle.usage": "java-runtime"
      },
      "files": [
        {
          "name": "junit-jupiter-api-5.6.0-M1-sources.jar",
          "url": "junit-jupiter-api-5.6.0-M1-sources.jar",
          "size": 154222,
          "sha512": "1e6e17a00a947066302ee512047d773a3d989e35fcb3aca160254415a3cfb4ba3ff5c661941a404e54d4860f5a350281858e4836401670ffd95afb68a5e9dca5",
          "sha256": "200d9fdc05057b96249209a791bfdc42b5db6025baa31a1d80a0f9c09998eb4b",
          "sha1": "8bf1b8cd955768d34b9a36c8d99e5769eb5ffa9d",
          "md5": "10fccfc21a2384afd31c0ca6dc8a1bc3"
        }
      ]
    }
  ]
}</code></pre></section><section id="published-platform-dependency"><h2>Published platform dependency</h2><div class="paragraph"><p><em>junit-jupiter-api-5.6.0-M1.module</em> (excerpt)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  {
    "name": "apiElements",
    "attributes": { "org.gradle.category": "library", ... },
    "dependencies": [
      {
        "group": "org.junit",
        "module": "junit-bom",
        "version": { "requires": "5.6.0" },
        "attributes": { "org.gradle.category": "platform" },
      }
    ]
  },</code></pre></section><section id="published-platform-bom"><h2>Published platform (BOM)</h2><div class="paragraph"><p><em>junit-bom-5.6.0-M1.module</em> (excerpt)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  {
    "name": "apiElements",
    "attributes": { "org.gradle.category": "platform", ... },
    "dependencyConstraints": [
      {
        "group": "org.junit.jupiter",
        "module": "junit-jupiter-engine",
        "version": { "requires": "5.6.0" }
      }
    ]
  },</code></pre>
<div class="paragraph"><p><em>build.gradle.kts</em> (consumer example)</p></div>
<pre class="highlight listingblock"><code data-noescape="" class="kotlin language-kotlin">dependencies {
    implementation("org.junit.jupiter:junit-jupiter-api:5.6.0")
    //                                  ↑↑↑ brings in 'junit-bom:5.6.0'
    implementation("org.junit.jupiter:junit-jupiter-engine:5.5.2")
    //           ↑↑↑ thanks to 'junit-bom:5.6.0' it will align to 5.6.0
}</code></pre></section><section id="the-guava-use-case"><h2>The Guava use case</h2><div class="ulist"><ul><li class="fragment"><p>Guava comes in two flavors</p><div class="ulist"><ul><li><p>a <code>jre</code> version, which effectively means Java 8+</p></li><li><p>an <code>android</code> version, which effectively means Java 6+</p></li></ul></div></li><li class="fragment"><p>To work around issues of having <em>both</em> on the classpath, the difference is encoded in the <em>version</em> string</p><div class="ulist"><ul><li><p><code>guava-28.1-jre</code> and <code>guava-28.1-android</code></p></li></ul></div></li><li class="fragment"><p>However none of this guarantees the correct version is used</p><div class="ulist"><ul><li><p>Maven&#8217;s nearest first may pick an <code>android</code> version while the <code>jre</code> would be better</p></li><li><p>Gradle&#8217;s global resolution could upgrade to the <code>jre</code> version while <code>android</code> must be used.</p></li></ul></div></li><li class="fragment"><p>Can we do better?</p></li></ul></div></section><section id="metadata-with-custom-variants"><h2>Metadata with custom variants</h2><div class="paragraph"><p><em>guava-28.1-jre.module</em> (how could it look like?)</p></div>
<pre class="highlight listingblock"><code data-noescape="">"variants": [
  { "name": "jdk6ApiElements", "dependencies": [ ... ],
    "attributes": { "org.gradle.jvm.version": 6, ... },
    "files": [{ "url": "../28.1-android/guava-28.1-android.jar" }]
  },
  { "name": "jdk8ApiElements", "dependencies": [ ... ],
    "attributes": { "org.gradle.jvm.version": 8, ... },
    "files": [{ "url": "guava-28.1-jre.jar" }]
  },
  { "name": "jdk6RuntimeElements" ... },
  { "name": "jdk8RuntimeElements" ... },</code></pre>
<div class="paragraph"><p><em>build.gradle.kts</em> (consumer example)</p></div>
<pre class="highlight listingblock"><code data-noescape="">dependencies {
    implementation("com.google.guava:guava:28.1-jre")
}
java {
    // 6 or 7 gets 'android.jar', 8+ gets 'jre.jar', &lt;6 fails
    targetCompatibility = JavaVersion.VERSION_1_6
}</code></pre></section><section id="details-details-details"><h2>Details, details, details</h2><div class="ulist"><ul><li class="fragment"><p>Gradle Module Metadata 1.0 was released with Gradle 5.3!</p></li><li class="fragment"><p>Gradle 6.0 uses format 1.1</p></li><li class="fragment"><p>Changes between these version are minor, mostly around variant attributes</p></li><li class="fragment"><p>Gradle 6.0 will automatically consume module metadata</p><div class="ulist"><ul><li><p>Thanks to a marker in published POM/Ivy files</p></li></ul></div></li></ul></div></section></section>
<section><section id="conclusion" data-background-color="#01303a"><h2>Conclusion</h2></section><section id="long-live-rich-metadata"><h2>Long live rich metadata!</h2><div class="ulist"><ul><li class="fragment"><p>Gradle 6.0 offers a <em>comprehensive</em> and <em>richer</em> solution for dependency management</p></li><li class="fragment"><p>Use it internally if you can!</p></li><li class="fragment"><p>Request it from known libraries that would benefit from it!</p></li><li class="fragment"><p>Escape "Dependency Hell"</p></li></ul></div></section></section>
<section id="thank-you" data-background-image="./images/thank-you.png" data-background-size="cover"></section></div></div><script src="reveal.js/lib/js/head.min.js"></script><script src="reveal.js/js/reveal.js"></script><script>Array.prototype.slice.call(document.querySelectorAll('.slides section')).forEach(function(slide) {
  if (slide.getAttribute('data-background-color')) return;
  // user needs to explicitly say he wants CSS color to override otherwise we might break custom css or theme (#226)
  if (!(slide.classList.contains('canvas') || slide.classList.contains('background'))) return;
  var bgColor = getComputedStyle(slide).backgroundColor;
  if (bgColor !== 'rgba(0, 0, 0, 0)' && bgColor !== 'transparent') {
    slide.setAttribute('data-background-color', bgColor);
    slide.style.backgroundColor = 'transparent';
  }
})

// See https://github.com/hakimel/reveal.js#configuration for a full list of configuration options
Reveal.initialize({
  // Display presentation control arrows
  controls: true,
  // Help the user learn the controls by providing hints, for example by
  // bouncing the down arrow when they first encounter a vertical slide
  controlsTutorial: true,
  // Determines where controls appear, "edges" or "bottom-right"
  controlsLayout: 'bottom-right',
  // Visibility rule for backwards navigation arrows; "faded", "hidden"
  // or "visible"
  controlsBackArrows: 'faded',
  // Display a presentation progress bar
  progress: true,
  // Display the page number of the current slide
  slideNumber: 'true',
  // Control which views the slide number displays on
  showSlideNumber: 'all',
  // Push each slide change to the browser history
  history: true,
  // Enable keyboard shortcuts for navigation
  keyboard: true,
  // Enable the slide overview mode
  overview: true,
  // Vertical centering of slides
  center: true,
  // Enables touch navigation on devices with touch input
  touch: true,
  // Loop the presentation
  loop: false,
  // Change the presentation direction to be RTL
  rtl: false,
  // Randomizes the order of slides each time the presentation loads
  shuffle: false,
  // Turns fragments on and off globally
  fragments: true,
  // Flags whether to include the current fragment in the URL,
  // so that reloading brings you to the same fragment position
  fragmentInURL: false,
  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,
  // Flags if we should show a help overlay when the questionmark
  // key is pressed
  help: true,
  // Flags if speaker notes should be visible to all viewers
  showNotes: false,
  // Global override for autolaying embedded media (video/audio/iframe)
  // - null: Media will only autoplay if data-autoplay is present
  // - true: All media will autoplay, regardless of individual setting
  // - false: No media will autoplay, regardless of individual setting
  autoPlayMedia: null,
  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,
  // Stop auto-sliding after user input
  autoSlideStoppable: true,
  // Use this method for navigation when auto-sliding
  autoSlideMethod: Reveal.navigateNext,
  // Specify the average time in seconds that you think you will spend
  // presenting each slide. This is used to show a pacing timer in the
  // speaker view
  defaultTiming: 120,
  // Enable slide navigation via mouse wheel
  mouseWheel: false,
  // Hides the address bar on mobile devices
  hideAddressBar: true,
  // Opens links in an iframe preview overlay
  // Add `data-preview-link` and `data-preview-link="false"` to customise each link
  // individually
  previewLinks: false,
  // Transition style (e.g., none, fade, slide, convex, concave, zoom)
  transition: 'linear',
  // Transition speed (e.g., default, fast, slow)
  transitionSpeed: 'default',
  // Transition style for full page slide backgrounds (e.g., none, fade, slide, convex, concave, zoom)
  backgroundTransition: 'fade',
  // Number of slides away from the current that are visible
  viewDistance: 3,
  // Parallax background image (e.g., "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'")
  parallaxBackgroundImage: '',
  // Parallax background size in CSS syntax (e.g., "2100px 900px")
  parallaxBackgroundSize: '',
  // Number of pixels to move the parallax background per slide
  // - Calculated automatically unless specified
  // - Set to 0 to disable movement along an axis
  parallaxBackgroundHorizontal: null,
  parallaxBackgroundVertical: null,
  // The display mode that will be used to show slides
  display: 'block',

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.5,

  // Optional libraries used to extend on reveal.js
  dependencies: [
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true },
      { src: 'reveal.js/plugin/notes/notes.js', async: true },
      
      
      
      
  ],

  

});</script><!-- this currently shows up at the wrong location in the final index.html which means the style font is not properly applied-->

<div class="footer">
</div></body></html>